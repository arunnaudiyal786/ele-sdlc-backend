# Flow Diagram Implementation Guide

Comprehensive visual guide to the AI Impact Assessment System's data flows, state transitions, and integration patterns.

## Table of Contents

- [System Overview Flow](#system-overview-flow)
- [2-Stage RAG Architecture](#2-stage-rag-architecture)
- [Indexing Deep Dive](#indexing-deep-dive)
- [LangGraph Workflow Flow](#langgraph-workflow-flow)
- [Agent Execution Flow](#agent-execution-flow)
- [Hybrid Search Flow](#hybrid-search-flow)
- [Context Assembly Flow](#context-assembly-flow)
- [Document Parsing Flow](#document-parsing-flow)
- [State Progression Flow](#state-progression-flow)
- [SSE Streaming Flow](#sse-streaming-flow)
- [Error Handling Flow](#error-handling-flow)
- [Data Storage Flow](#data-storage-flow)
- [Configuration Reference](#configuration-reference)

---

## System Overview Flow

High-level view of how a requirement flows through the entire system.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          END-TO-END SYSTEM FLOW                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚   USER                    FRONTEND                    BACKEND                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚     â”‚  Enter          â”‚         â”‚  POST          â”‚                     â”‚  â”‚
â”‚  â”‚  ðŸ‘¤ â”‚  Requirement    â”‚ Next.js â”‚  /impact/      â”‚    FastAPI          â”‚  â”‚
â”‚  â”‚     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º   â”‚   UI    â”‚  run-pipeline  â”‚    (Port 8000)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜                 â”‚         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚  â”‚
â”‚     â”‚                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚                         â”‚                                â”‚              â”‚
â”‚     â”‚                         â”‚   SSE Stream                   â”‚              â”‚
â”‚     â”‚   View Progress         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚              â”‚
â”‚     â”‚                         â”‚                                â–¼              â”‚
â”‚     â”‚                         â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚     â”‚                         â”‚                    â”‚    LangGraph          â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚    Workflow           â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚                       â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â”‚ 7 Agents        â”‚  â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â”‚ Sequential      â”‚  â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â”‚ Execution       â”‚  â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚           â”‚           â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚           â–¼           â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â”‚ ChromaDB Search â”‚  â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â”‚ Ollama LLM      â”‚  â”‚ â”‚
â”‚     â”‚                         â”‚                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚     â”‚                         â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚     â”‚                         â”‚                                â”‚              â”‚
â”‚     â”‚   View Results          â”‚   Final Response               â”‚              â”‚
â”‚     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2-Stage RAG Architecture

The system uses a modern 2-stage RAG architecture for efficient search and document retrieval.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        2-STAGE RAG ARCHITECTURE                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  STAGE 1: LIGHTWEIGHT PROJECT INDEX (Built at Startup)                  â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   data/raw/projects/                     ChromaDB: project_index         â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ PRJ-10051-inventory-sync/     â”€â”€â–º  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚   â””â”€â”€ tdd.docx (parse 1.1)          â”‚ project_id: PRJ-10051     â”‚   â”‚ â”‚
â”‚  â”‚   â”œâ”€â”€ PRJ-10052-order-fulfillment/      â”‚ project_name: Inventory   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚   â””â”€â”€ tdd.docx (parse 1.1)          â”‚ summary: "Real-time..."   â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€ PRJ-10053-claims-processing/      â”‚ folder_path: /abs/path    â”‚   â”‚ â”‚
â”‚  â”‚       â””â”€â”€ tdd.docx (parse 1.1)          â”‚ tdd_path: /abs/tdd.docx   â”‚   â”‚ â”‚
â”‚  â”‚                                          â”‚ estimation_path: /abs/... â”‚   â”‚ â”‚
â”‚  â”‚   Extracted from TDD:                    â”‚ jira_stories_path: ...    â”‚   â”‚ â”‚
â”‚  â”‚   â€¢ project_name (from References)       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚   â€¢ summary (from 1.1 Purpose)                                          â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   Embedding: "{project_name} {summary}" â†’ 384-dim vector                â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚                                       â”‚
â”‚                                      â”‚ User Query                            â”‚
â”‚                                      â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  HYBRID SEARCH (70% Semantic + 30% Keyword)                             â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚ â”‚
â”‚  â”‚   Query: "Build real-time inventory tracking"                           â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   Results: [PRJ-10051 (0.85), PRJ-10053 (0.72), PRJ-10052 (0.65)]      â”‚ â”‚
â”‚  â”‚   â””â”€â–º Top 3 selected automatically                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â”‚                                       â”‚
â”‚                                      â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  STAGE 2: ON-DEMAND DOCUMENT LOADING (At Runtime)                       â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   For each selected project (e.g., PRJ-10051):                          â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚   â”‚  Load Full Documents via ContextAssembler                        â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                                                                   â”‚  â”‚ â”‚
â”‚  â”‚   â”‚  tdd.docx â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º TDDParser.parse() â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º TDDDocument   â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ epic_description (1.1 Purpose)            â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ scope (1.4 Scope)                         â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ module_list (2.1 table)                   â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ design_patterns (2.4)                     â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ module_designs (Section 3)                â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ full_text (complete doc)                  â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                                                                   â”‚  â”‚ â”‚
â”‚  â”‚   â”‚  estimation.xlsx â”€â”€â–º EstimationParser.parse() â”€â–º EstimationDoc  â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ task_breakdown[]                          â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ total_dev_points, total_qa_points         â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ assumptions_and_risks[]                   â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                                                                   â”‚  â”‚ â”‚
â”‚  â”‚   â”‚  jira_stories.xlsx â–º JiraStoriesParser.parse() â–º JiraStoriesDoc â”‚  â”‚ â”‚
â”‚  â”‚   â”‚                      â€¢ stories[] (jira_id, description, points)  â”‚  â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   Result: loaded_projects = {                                           â”‚ â”‚
â”‚  â”‚     "PRJ-10051": ProjectDocuments(tdd, estimation, jira_stories),       â”‚ â”‚
â”‚  â”‚     "PRJ-10052": ProjectDocuments(...),                                 â”‚ â”‚
â”‚  â”‚     "PRJ-10053": ProjectDocuments(...)                                  â”‚ â”‚
â”‚  â”‚   }                                                                      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â”‚  Benefits:                                                                    â”‚
â”‚  âœ“ Fast search on lightweight metadata (no full docs in ChromaDB)           â”‚
â”‚  âœ“ Full document parsing only when needed (3 projects at a time)            â”‚
â”‚  âœ“ Structured parsing extracts specific sections for each agent             â”‚
â”‚  âœ“ Absolute file paths stored in index for reliable document loading        â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Indexing Deep Dive

Complete technical breakdown of the indexing process.

### Project Folder Structure

```
data/raw/projects/
â”œâ”€â”€ PRJ-10051-inventory-sync-automation/
â”‚   â”œâ”€â”€ tdd.docx              # Technical Design Document (required)
â”‚   â”œâ”€â”€ estimation.xlsx       # Effort estimation spreadsheet
â”‚   â””â”€â”€ jira_stories.xlsx     # Existing Jira stories as templates
â”‚
â”œâ”€â”€ PRJ-10052-order-fulfillment/
â”‚   â”œâ”€â”€ tdd.docx
â”‚   â”œâ”€â”€ estimation.xlsx
â”‚   â””â”€â”€ jira_stories.xlsx
â”‚
â””â”€â”€ PRJ-10053-claims-processing/
    â”œâ”€â”€ tdd.docx
    â”œâ”€â”€ estimation.xlsx
    â””â”€â”€ jira_stories.xlsx
```

### Indexing Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           INDEXING FLOW                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚   $ python scripts/init_vector_db.py                                         â”‚
â”‚        â”‚                                                                      â”‚
â”‚        â–¼                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚  ProjectIndexer.get_instance()                                          â”‚â”‚
â”‚   â”‚  Location: app/services/project_indexer.py                              â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  Singleton initialization:                                               â”‚â”‚
â”‚   â”‚  â€¢ ChromaVectorStore(persist_dir=settings.chroma_persist_dir)           â”‚â”‚
â”‚   â”‚  â€¢ OllamaEmbeddingService()                                             â”‚â”‚
â”‚   â”‚  â€¢ collection_name = "project_index"                                     â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚        â”‚                                                                      â”‚
â”‚        â–¼                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚  indexer.build_index(base_path="data/raw/projects")                     â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  Step 1: Scan project folders                                            â”‚â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚â”‚
â”‚   â”‚  for project_folder in base_path.iterdir():                              â”‚â”‚
â”‚   â”‚      if project_folder.is_dir() and not starts_with("."):               â”‚â”‚
â”‚   â”‚          metadata = await extract_metadata(project_folder)               â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  Step 2: Delete existing collection (if rebuilding)                      â”‚â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚â”‚
â”‚   â”‚  await vector_store.delete_collection("project_index")                   â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  Step 3: Index each project                                              â”‚â”‚
â”‚   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚â”‚
â”‚   â”‚  for project in projects:                                                â”‚â”‚
â”‚   â”‚      await _index_project(project)                                       â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚        â”‚                                                                      â”‚
â”‚        â–¼                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚  extract_metadata(project_folder) â†’ ProjectMetadata                     â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚   â”‚  â”‚  1. Extract project_id from folder name                            â”‚ â”‚â”‚
â”‚   â”‚  â”‚     "PRJ-10051-inventory-sync" â†’ "PRJ-10051"                        â”‚ â”‚â”‚
â”‚   â”‚  â”‚     Pattern: re.match(r"(PRJ-\d+)", folder_name)                    â”‚ â”‚â”‚
â”‚   â”‚  â”‚                                                                     â”‚ â”‚â”‚
â”‚   â”‚  â”‚  2. Load TDD document                                               â”‚ â”‚â”‚
â”‚   â”‚  â”‚     doc = Document(str(tdd_path))  # python-docx                    â”‚ â”‚â”‚
â”‚   â”‚  â”‚                                                                     â”‚ â”‚â”‚
â”‚   â”‚  â”‚  3. Extract project_name from References section                    â”‚ â”‚â”‚
â”‚   â”‚  â”‚     Search for "PRJ-XXXXX Project Charter" pattern                  â”‚ â”‚â”‚
â”‚   â”‚  â”‚     Fallback: Derive from folder name                               â”‚ â”‚â”‚
â”‚   â”‚  â”‚     "PRJ-10051-inventory-sync" â†’ "Inventory Sync"                   â”‚ â”‚â”‚
â”‚   â”‚  â”‚                                                                     â”‚ â”‚â”‚
â”‚   â”‚  â”‚  4. Extract summary from 1.1 Purpose section                        â”‚ â”‚â”‚
â”‚   â”‚  â”‚     Find heading containing "1.1" and "Purpose"                     â”‚ â”‚â”‚
â”‚   â”‚  â”‚     Return next non-empty paragraph (>20 chars)                     â”‚ â”‚â”‚
â”‚   â”‚  â”‚                                                                     â”‚ â”‚â”‚
â”‚   â”‚  â”‚  5. Build metadata object with absolute paths                       â”‚ â”‚â”‚
â”‚   â”‚  â”‚     folder_path = str(project_folder.absolute())                    â”‚ â”‚â”‚
â”‚   â”‚  â”‚     tdd_path = str(tdd_path.absolute())                             â”‚ â”‚â”‚
â”‚   â”‚  â”‚     estimation_path = str(estimation_path.absolute())               â”‚ â”‚â”‚
â”‚   â”‚  â”‚     jira_stories_path = str(jira_stories_path.absolute())           â”‚ â”‚â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚        â”‚                                                                      â”‚
â”‚        â–¼                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚  _index_project(metadata) â†’ ChromaDB                                    â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  1. Generate embedding                                                   â”‚â”‚
â”‚   â”‚     document_text = f"{project_name} {summary}"                          â”‚â”‚
â”‚   â”‚     embedding = await embedding_service.embed(document_text)             â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚     OllamaEmbeddingService:                                              â”‚â”‚
â”‚   â”‚     â€¢ Model: all-minilm (384 dimensions)                                 â”‚â”‚
â”‚   â”‚     â€¢ Preprocessing: lowercase, normalize whitespace, truncate 400 wordsâ”‚â”‚
â”‚   â”‚     â€¢ POST http://localhost:11434/api/embed                              â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  2. Prepare ChromaDB document                                            â”‚â”‚
â”‚   â”‚     {                                                                    â”‚â”‚
â”‚   â”‚       "id": "PRJ-10051",                                                 â”‚â”‚
â”‚   â”‚       "text": "Inventory Sync Automation Real-time inventory..."        â”‚â”‚
â”‚   â”‚       "metadata": {                                                      â”‚â”‚
â”‚   â”‚         "project_id": "PRJ-10051",                                       â”‚â”‚
â”‚   â”‚         "project_name": "Inventory Sync Automation",                     â”‚â”‚
â”‚   â”‚         "summary": "Real-time inventory tracking...",                    â”‚â”‚
â”‚   â”‚         "folder_path": "/abs/path/to/PRJ-10051-inventory-sync",          â”‚â”‚
â”‚   â”‚         "tdd_path": "/abs/path/to/PRJ-10051.../tdd.docx",                â”‚â”‚
â”‚   â”‚         "estimation_path": "/abs/path/to/.../estimation.xlsx",           â”‚â”‚
â”‚   â”‚         "jira_stories_path": "/abs/path/to/.../jira_stories.xlsx",       â”‚â”‚
â”‚   â”‚         "indexed_at": "2026-01-25T10:30:00"                              â”‚â”‚
â”‚   â”‚       }                                                                  â”‚â”‚
â”‚   â”‚     }                                                                    â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  3. Add to ChromaDB                                                      â”‚â”‚
â”‚   â”‚     collection.add(                                                      â”‚â”‚
â”‚   â”‚       ids=["PRJ-10051"],                                                 â”‚â”‚
â”‚   â”‚       embeddings=[embedding],  # 384-dim vector                          â”‚â”‚
â”‚   â”‚       documents=["Inventory Sync Automation Real-time..."],              â”‚â”‚
â”‚   â”‚       metadatas=[{...}]                                                  â”‚â”‚
â”‚   â”‚     )                                                                    â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚        â”‚                                                                      â”‚
â”‚        â–¼                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚   â”‚  ChromaDB Storage                                                       â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  Location: data/chroma/                                                  â”‚â”‚
â”‚   â”‚  Collection: impact_assessment_project_index                             â”‚â”‚
â”‚   â”‚  (prefix from settings.chroma_collection_prefix)                         â”‚â”‚
â”‚   â”‚                                                                          â”‚â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚
â”‚   â”‚  â”‚  Indexed Data (per project):                                       â”‚ â”‚â”‚
â”‚   â”‚  â”‚  â€¢ ID: PRJ-10051                                                   â”‚ â”‚â”‚
â”‚   â”‚  â”‚  â€¢ Document: "Inventory Sync Automation Real-time inventory..."    â”‚ â”‚â”‚
â”‚   â”‚  â”‚  â€¢ Embedding: [0.123, -0.456, 0.789, ...] (384 floats)            â”‚ â”‚â”‚
â”‚   â”‚  â”‚  â€¢ Metadata: project_id, project_name, summary, file paths         â”‚ â”‚â”‚
â”‚   â”‚  â”‚                                                                     â”‚ â”‚â”‚
â”‚   â”‚  â”‚  HNSW Index Settings:                                              â”‚ â”‚â”‚
â”‚   â”‚  â”‚  â€¢ hnsw:space = "cosine" (cosine similarity)                       â”‚ â”‚â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                               â”‚
â”‚  Output:                                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚  âœ… SUCCESS: Indexed 3 projects                                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Indexing Scripts Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        INDEXING SCRIPTS                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  scripts/init_vector_db.py                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  Purpose: Build project_index from data/raw/projects/                        â”‚
â”‚  Usage:   python scripts/init_vector_db.py                                   â”‚
â”‚  When:    First-time setup, after adding new project folders                 â”‚
â”‚                                                                               â”‚
â”‚  scripts/reindex.py                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  Purpose: Delete legacy collections (epics, estimations, tdds, stories)      â”‚
â”‚  Usage:   python scripts/reindex.py                                          â”‚
â”‚  When:    Before migrating from old CSV-based indexing                       â”‚
â”‚                                                                               â”‚
â”‚  scripts/rebuild_project_index.py                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚
â”‚  Purpose: Rebuild only the project_index collection                          â”‚
â”‚  Usage:   python scripts/rebuild_project_index.py                            â”‚
â”‚  When:    After modifying project folders without full reindex               â”‚
â”‚                                                                               â”‚
â”‚  Full Reindex Workflow:                                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚  $ python scripts/reindex.py && python scripts/init_vector_db.py             â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## LangGraph Workflow Flow

Detailed view of the LangGraph workflow with all nodes and edges.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         LANGGRAPH WORKFLOW FLOW                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚   START                                                                       â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. REQUIREMENT AGENT                                                   â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚  â”‚
â”‚  â”‚  Input:  requirement_text                                               â”‚  â”‚
â”‚  â”‚  Action: Extract keywords, normalize text                               â”‚  â”‚
â”‚  â”‚  Output: extracted_keywords[]                                           â”‚  â”‚
â”‚  â”‚  Status: requirement_submitted                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  2. HISTORICAL MATCH AGENT                                              â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚  â”‚
â”‚  â”‚  Input:  requirement_text + extracted_keywords                          â”‚  â”‚
â”‚  â”‚  Action: Hybrid search (70% semantic + 30% keyword)                     â”‚  â”‚
â”‚  â”‚          Search: project_index collection                               â”‚  â”‚
â”‚  â”‚  Output: all_matches[] (ranked by combined score)                       â”‚  â”‚
â”‚  â”‚  Status: matches_found                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚  â”‚ Conditional Edge    â”‚                                                     â”‚
â”‚  â”‚ route_after_        â”‚                                                     â”‚
â”‚  â”‚ historical_match()  â”‚                                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚             â”‚                                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚     â–¼               â–¼                                                        â”‚
â”‚  [auto_select]  [error_handler] â”€â”€â–º END                                      â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  3. AUTO-SELECT NODE                                                    â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                  â”‚  â”‚
â”‚  â”‚  Input:  all_matches[]                                                  â”‚  â”‚
â”‚  â”‚  Action: 1. Select top 3 matches by score                               â”‚  â”‚
â”‚  â”‚          2. Get project metadata from HybridSearchService               â”‚  â”‚
â”‚  â”‚          3. Load full documents via ContextAssembler:                   â”‚  â”‚
â”‚  â”‚             - TDDParser.parse(tdd_path)                                 â”‚  â”‚
â”‚  â”‚             - EstimationParser.parse(estimation_path)                   â”‚  â”‚
â”‚  â”‚             - JiraStoriesParser.parse(jira_stories_path)                â”‚  â”‚
â”‚  â”‚  Output: selected_matches[], loaded_projects{}                          â”‚  â”‚
â”‚  â”‚  Status: matches_selected                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  4. IMPACTED MODULES AGENT                                              â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚  â”‚
â”‚  â”‚  Input:  requirement_text + loaded_projects (TDD module data)           â”‚  â”‚
â”‚  â”‚  Context: epic_description, module_list[], interaction_flow,            â”‚  â”‚
â”‚  â”‚           design_decisions, design_patterns, risks                      â”‚  â”‚
â”‚  â”‚  Action: LLM identifies functional & technical modules                  â”‚  â”‚
â”‚  â”‚  Output: functional_modules[], technical_modules[], impact_summary      â”‚  â”‚
â”‚  â”‚  Status: impacted_modules_generated                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  5. ESTIMATION EFFORT AGENT                                             â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚  â”‚
â”‚  â”‚  Input:  requirement_text + loaded_projects (estimation data)           â”‚  â”‚
â”‚  â”‚          + impacted_modules_output (filtered modules from step 4)       â”‚  â”‚
â”‚  â”‚  Context: epic_description, task_breakdown[], total_dev_points,         â”‚  â”‚
â”‚  â”‚           total_qa_points, impacted_modules, assumptions_and_risks      â”‚  â”‚
â”‚  â”‚  Action: LLM estimates effort based on historical patterns              â”‚  â”‚
â”‚  â”‚  Output: dev_hours, qa_hours, story_points, confidence_level            â”‚  â”‚
â”‚  â”‚  Status: estimation_effort_completed                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  6. TDD AGENT                                                           â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                           â”‚  â”‚
â”‚  â”‚  Input:  requirement_text + loaded_projects (full TDD data)             â”‚  â”‚
â”‚  â”‚  Context: epic_description, scope, design_overview, design_patterns,    â”‚  â”‚
â”‚  â”‚           design_decisions, module_list[], module_designs[],            â”‚  â”‚
â”‚  â”‚           interaction_flow, full_tdd_text                               â”‚  â”‚
â”‚  â”‚  Action: LLM generates Technical Design Document                        â”‚  â”‚
â”‚  â”‚  Output: tdd_name, design_patterns, components[], tdd.md file           â”‚  â”‚
â”‚  â”‚  Status: tdd_generated                                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  7. JIRA STORIES AGENT                                                  â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚  â”‚
â”‚  â”‚  Input:  requirement_text + loaded_projects (jira stories data)         â”‚  â”‚
â”‚  â”‚  Context: epic_description, existing_stories[], task_breakdown[],       â”‚  â”‚
â”‚  â”‚           total_dev_points, total_qa_points                             â”‚  â”‚
â”‚  â”‚  Action: LLM generates user stories and tasks                           â”‚  â”‚
â”‚  â”‚  Output: stories[] with summary, description, story_points              â”‚  â”‚
â”‚  â”‚  Status: jira_stories_generated â†’ completed                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚     â”‚                                                                         â”‚
â”‚     â–¼                                                                         â”‚
â”‚   END                                                                         â”‚
â”‚                                                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        DISABLED AGENTS (Future)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [DISABLED] CODE IMPACT AGENT                                           â”‚  â”‚
â”‚  â”‚  Would analyze code repositories affected by requirement                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  [DISABLED] RISKS AGENT                                                 â”‚  â”‚
â”‚  â”‚  Would assess risks based on all previous outputs                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Agent Execution Flow

How each agent processes within the workflow.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AGENT EXECUTION PATTERN                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  LangGraph calls agent                                                        â”‚
â”‚        â”‚                                                                      â”‚
â”‚        â–¼                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  AGENT WRAPPER (e.g., tdd_agent)                                        â”‚ â”‚
â”‚  â”‚  Location: app/components/{name}/agent.py                               â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  async def tdd_agent(state: Dict[str, Any]) -> Dict[str, Any]:         â”‚ â”‚
â”‚  â”‚      â”‚                                                                   â”‚ â”‚
â”‚  â”‚      â”œâ”€â–º 1. Extract data from state                                     â”‚ â”‚
â”‚  â”‚      â”‚      session_id = state["session_id"]                            â”‚ â”‚
â”‚  â”‚      â”‚      requirement = state["requirement_text"]                      â”‚ â”‚
â”‚  â”‚      â”‚      loaded_projects = state["loaded_projects"]                   â”‚ â”‚
â”‚  â”‚      â”‚                                                                   â”‚ â”‚
â”‚  â”‚      â”œâ”€â–º 2. Create service request                                      â”‚ â”‚
â”‚  â”‚      â”‚      request = TDDRequest(                                        â”‚ â”‚
â”‚  â”‚      â”‚          session_id=session_id,                                   â”‚ â”‚
â”‚  â”‚      â”‚          requirement_text=requirement,                            â”‚ â”‚
â”‚  â”‚      â”‚          loaded_projects=loaded_projects,                         â”‚ â”‚
â”‚  â”‚      â”‚      )                                                            â”‚ â”‚
â”‚  â”‚      â”‚                                                                   â”‚ â”‚
â”‚  â”‚      â”œâ”€â–º 3. Call service                                                â”‚ â”‚
â”‚  â”‚      â”‚      service = get_tdd_service()                                 â”‚ â”‚
â”‚  â”‚      â”‚      response = await service.process(request)                    â”‚ â”‚
â”‚  â”‚      â”‚                    â”‚                                              â”‚ â”‚
â”‚  â”‚      â”‚                    â–¼                                              â”‚ â”‚
â”‚  â”‚      â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚  SERVICE (TDDService)           â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚  â€¢ Assemble LLM context         â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚    via ContextAssembler         â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚  â€¢ Call Ollama generate         â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚    (phi3:mini model)            â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚  â€¢ Parse JSON response          â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚    via parse_llm_json()         â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚  â€¢ Save to audit trail          â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚    via AuditTrailManager        â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â”‚  â€¢ Return TDDResponse           â”‚                 â”‚ â”‚
â”‚  â”‚      â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ â”‚
â”‚  â”‚      â”‚                                                                   â”‚ â”‚
â”‚  â”‚      â””â”€â–º 4. Return PARTIAL state update                                 â”‚ â”‚
â”‚  â”‚           return {                                                       â”‚ â”‚
â”‚  â”‚               "tdd_output": response.model_dump(),                       â”‚ â”‚
â”‚  â”‚               "status": "tdd_generated",                                 â”‚ â”‚
â”‚  â”‚               "current_agent": "jira_stories",                           â”‚ â”‚
â”‚  â”‚               "messages": [{"role": "tdd", "content": "..."}],          â”‚ â”‚
â”‚  â”‚           }                                                              â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚        â”‚                                                                      â”‚
â”‚        â–¼                                                                      â”‚
â”‚  LangGraph MERGES partial update into full state                             â”‚
â”‚  (messages field uses operator.add reducer for append-only accumulation)     â”‚
â”‚        â”‚                                                                      â”‚
â”‚        â–¼                                                                      â”‚
â”‚  Next agent called with updated state                                         â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Hybrid Search Flow

How the hybrid search combines semantic and keyword matching.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          HYBRID SEARCH FLOW                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  Input: "Build user authentication system with OAuth 2.0"                     â”‚
â”‚                                                                               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚         â”‚                                                                â”‚    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”‚
â”‚    â”‚  Query  â”‚                                            â”‚  ChromaDB  â”‚â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                            â”‚ project_   â”‚â”‚    â”‚
â”‚         â”‚                                                 â”‚ index      â”‚â”‚    â”‚
â”‚         â”‚                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â”‚
â”‚         â”‚                                                               â”‚    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚    â”‚                      PARALLEL PROCESSING                      â”‚    â”‚    â”‚
â”‚    â”‚                                                                â”‚    â”‚    â”‚
â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚   SEMANTIC SEARCH       â”‚   â”‚   KEYWORD EXTRACTION    â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚                         â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚   1. Preprocess query   â”‚   â”‚   1. Extract keywords    â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      lowercase,         â”‚   â”‚      from query          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      normalize,         â”‚   â”‚      via extract_        â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      truncate 400 words â”‚   â”‚      keywords()          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚                         â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚   2. Embed query        â”‚   â”‚   2. Remove stopwords:   â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      via Ollama         â”‚   â”‚      the, a, an, is...   â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      all-minilm         â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      (384 dimensions)   â”‚   â”‚   3. Result keywords:    â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚                         â”‚   â”‚      ["build", "user",   â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚   3. Vector similarity  â”‚   â”‚       "authentication",  â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      search in ChromaDB â”‚   â”‚       "oauth", "system"] â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      (cosine distance)  â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚                         â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚   4. Results:           â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      PRJ-001: 0.89      â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      PRJ-002: 0.82      â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚      PRJ-003: 0.78      â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â”‚                         â”‚   â”‚                          â”‚   â”‚    â”‚    â”‚
â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚    â”‚
â”‚    â”‚               â”‚                              â”‚                  â”‚    â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚                    â”‚                              â”‚                       â”‚    â”‚
â”‚                    â–¼                              â–¼                       â”‚    â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚              â”‚        KEYWORD SCORING (per document)            â”‚         â”‚    â”‚
â”‚              â”‚        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚         â”‚    â”‚
â”‚              â”‚                                                  â”‚         â”‚    â”‚
â”‚              â”‚   For each semantic result:                      â”‚         â”‚    â”‚
â”‚              â”‚   1. Get document text from result               â”‚         â”‚    â”‚
â”‚              â”‚   2. Calculate keyword overlap:                  â”‚         â”‚    â”‚
â”‚              â”‚      keyword_score = matches / total_keywords    â”‚         â”‚    â”‚
â”‚              â”‚                                                  â”‚         â”‚    â”‚
â”‚              â”‚   PRJ-001: 3/5 keywords found = 0.60            â”‚         â”‚    â”‚
â”‚              â”‚   PRJ-003: 4/5 keywords found = 0.80            â”‚         â”‚    â”‚
â”‚              â”‚   PRJ-002: 1/5 keywords found = 0.20            â”‚         â”‚    â”‚
â”‚              â”‚                                                  â”‚         â”‚    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚                                      â”‚                                   â”‚    â”‚
â”‚                                      â–¼                                   â”‚    â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    â”‚
â”‚              â”‚               SCORE FUSION                       â”‚         â”‚    â”‚
â”‚              â”‚               â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚         â”‚    â”‚
â”‚              â”‚                                                  â”‚         â”‚    â”‚
â”‚              â”‚   Final = (0.70 Ã— Semantic) + (0.30 Ã— Keyword)  â”‚         â”‚    â”‚
â”‚              â”‚                                                  â”‚         â”‚    â”‚
â”‚              â”‚   PRJ-001: (0.70 Ã— 0.89) + (0.30 Ã— 0.60) = 0.80 â”‚         â”‚    â”‚
â”‚              â”‚   PRJ-003: (0.70 Ã— 0.78) + (0.30 Ã— 0.80) = 0.79 â”‚         â”‚    â”‚
â”‚              â”‚   PRJ-002: (0.70 Ã— 0.82) + (0.30 Ã— 0.20) = 0.63 â”‚         â”‚    â”‚
â”‚              â”‚                                                  â”‚         â”‚    â”‚
â”‚              â”‚   Ranked: PRJ-001, PRJ-003, PRJ-002              â”‚         â”‚    â”‚
â”‚              â”‚                                                  â”‚         â”‚    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚    â”‚
â”‚                                                                          â”‚    â”‚
â”‚         Output: List[ProjectMatch] with score_breakdown per match        â”‚    â”‚
â”‚         {                                                                â”‚    â”‚
â”‚           "project_id": "PRJ-001",                                       â”‚    â”‚
â”‚           "project_name": "Authentication Module",                       â”‚    â”‚
â”‚           "summary": "OAuth2 authentication implementation...",          â”‚    â”‚
â”‚           "match_score": 0.80,                                           â”‚    â”‚
â”‚           "score_breakdown": {                                           â”‚    â”‚
â”‚             "semantic_score": 0.89,                                      â”‚    â”‚
â”‚             "keyword_score": 0.60                                        â”‚    â”‚
â”‚           },                                                             â”‚    â”‚
â”‚           "folder_path": "/abs/path/to/PRJ-001-auth",                    â”‚    â”‚
â”‚           "tdd_path": "/abs/path/to/tdd.docx",                           â”‚    â”‚
â”‚           "estimation_path": "/abs/path/to/estimation.xlsx",             â”‚    â”‚
â”‚           "jira_stories_path": "/abs/path/to/jira_stories.xlsx"          â”‚    â”‚
â”‚         }                                                                â”‚    â”‚
â”‚                                                                          â”‚    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Context Assembly Flow

How full documents are loaded and assembled for agents.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CONTEXT ASSEMBLY FLOW                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  After auto_select: selected_matches = [PRJ-001, PRJ-002, PRJ-003]           â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     ContextAssembler.load_full_documents()               â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  For each project in selected_matches:                                   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  PRJ-001                                                           â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  data/raw/projects/PRJ-001-authentication/                         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ tdd.docx â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º TDDParser.parse() â”€â”€â”€â”€â”€â”€â–º TDDDocument   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                                 â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”œâ”€â”€ estimation.xlsx â”€â”€â–º EstimationParser.parse() â–º EstimationDoc â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                                                 â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€ jira_stories.xlsx â”€â–º JiraStoriesParser.parse() â–º JiraStories â”‚ â”‚ â”‚
â”‚  â”‚  â”‚                                                                     â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Result: loaded_projects = {                                            â”‚ â”‚
â”‚  â”‚    "PRJ-001": ProjectDocuments(                                         â”‚ â”‚
â”‚  â”‚      project_id="PRJ-001",                                              â”‚ â”‚
â”‚  â”‚      tdd=TDDDocument(...),                                              â”‚ â”‚
â”‚  â”‚      estimation=EstimationDocument(...),                                â”‚ â”‚
â”‚  â”‚      jira_stories=JiraStoriesDocument(...)                              â”‚ â”‚
â”‚  â”‚    ),                                                                    â”‚ â”‚
â”‚  â”‚    "PRJ-002": ProjectDocuments(...),                                    â”‚ â”‚
â”‚  â”‚    "PRJ-003": ProjectDocuments(...)                                     â”‚ â”‚
â”‚  â”‚  }                                                                       â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â”‚                                      â”‚                                        â”‚
â”‚                                      â–¼                                        â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                 Agent-Specific Context Assembly                          â”‚ â”‚
â”‚  â”‚                 (via assemble_agent_context())                           â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Each agent receives DIFFERENT subsets of the loaded documents:          â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  impacted_modules agent receives:                                â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ epic_description                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ module_list[] (system, component_name, type, new/existing)    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ interaction_flow                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ design_decisions                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ design_patterns[]                                             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ risks[]                                                       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Source: TDD document                                            â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  estimation_effort agent receives:                               â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ epic_description                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ total_dev_points, total_qa_points                             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ task_breakdown[] (ticket_id, description, dev/qa points)      â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ impacted_modules (from impacted_modules agent output!)        â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ assumptions_and_risks[]                                       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Source: Estimation doc + impacted_modules_output                â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  tdd agent receives:                                             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ epic_description                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ scope                                                         â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ design_overview                                               â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ design_patterns[]                                             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ design_decisions                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ module_list[]                                                 â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ module_designs[] (module_name, description, code_samples)     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ interaction_flow                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ full_tdd_text (complete document)                             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Source: Full TDD documents                                      â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚  jira_stories agent receives:                                    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ epic_description                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ existing_stories[] (jira_id, description, story_points)       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ task_breakdown[]                                              â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â€¢ total_dev_points, total_qa_points                             â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Source: Jira Stories doc + Estimation doc                       â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Document Parsing Flow

How each document type is parsed into structured data.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DOCUMENT PARSING FLOW                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  TDD PARSER (app/services/parsers/tdd_parser.py)                        â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Input: tdd.docx (Word document via python-docx)                        â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Extraction Strategy:                                                    â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Section                  â”‚ Extraction Method                       â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚  project_id               â”‚ Regex from folder name (PRJ-\d+)       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  project_name             â”‚ References section or folder fallback   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  epic_description         â”‚ Paragraph after "1.1 Purpose" heading   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  scope                    â”‚ Section "1.4 Scope"                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  references[]             â”‚ Section "1.2 References"                â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  glossary{}               â”‚ First table with Term/Definition cols   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  assumptions[]            â”‚ Section "1.5 Assumptions"               â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  design_overview          â”‚ Section "2. Design Overview"            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  module_list[]            â”‚ Module List table (System, Component)   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  interaction_flow         â”‚ Section "2.2 Modules Interaction Flow"  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  design_decisions         â”‚ Section "2.3 Key Design Decisions"      â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  design_patterns[]        â”‚ Section "2.4 Design Patterns"           â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  risks[]                  â”‚ Section "2.5 Risks"                     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  module_designs[]         â”‚ Section 3 (SVC/MOD/BTH headings)        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  full_text                â”‚ All paragraphs concatenated             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  tables[]                 â”‚ All tables with context headings        â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Output: TDDDocument (Pydantic model)                                   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ESTIMATION PARSER (app/services/parsers/estimation_parser.py)          â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Input: estimation.xlsx (Excel via pandas)                              â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Sheet Discovery (fuzzy matching):                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Target Sheet            â”‚ Keywords Searched                        â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚  Task Breakdown          â”‚ "task breakdown", "breakdown", "tasks"   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Dev Estimate            â”‚ "dev estimate", "development"            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  QA Estimate             â”‚ "qa estimate", "testing"                 â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Assumptions             â”‚ "assumptions", "risks"                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  Sizing Guidelines       â”‚ "sizing", "guidelines"                   â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Column Normalization:                                                   â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Standard Name       â”‚ Variations Matched                           â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚  module              â”‚ module, component, module_affected, area     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  task_description    â”‚ description, task description, work_item     â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  dev_points          â”‚ dev_effort, development points, story_points â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  qa_points           â”‚ qa_effort, testing effort, qa points         â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  ticket_id           â”‚ jira_id, story_id, id, key                   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  notes               â”‚ comments, remarks                            â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Story Points Parsing:                                                   â”‚ â”‚
â”‚  â”‚  â€¢ Handles "DEV: 45 Points\nQA: 25 Points" format                       â”‚ â”‚
â”‚  â”‚  â€¢ Handles separate dev_points/qa_points columns                        â”‚ â”‚
â”‚  â”‚  â€¢ Handles single combined points value                                  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Output: EstimationDocument with task_breakdown[], totals               â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  JIRA STORIES PARSER (app/services/parsers/jira_stories_parser.py)      â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Input: jira_stories.xlsx (Excel via pandas)                            â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Sheet: "Jira Stories" (fallback to first sheet)                        â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Column Discovery:                                                       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚  Field            â”‚ Keywords Searched                               â”‚ â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚
â”‚  â”‚  â”‚  jira_id          â”‚ jiraid, jira_id, story_id, id, key             â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  description      â”‚ jira_description, description, summary, story   â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  story_points     â”‚ story_points, story points, points              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  priority         â”‚ priority                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  status           â”‚ status                                          â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  Output: JiraStoriesDocument with stories[]                             â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Progression Flow

How the workflow state evolves through pipeline execution.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        STATE PROGRESSION FLOW                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  Initial State (from API request)                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ {                                                                        â”‚ â”‚
â”‚  â”‚   session_id: "sess-123",                                               â”‚ â”‚
â”‚  â”‚   requirement_text: "Build OAuth system...",                            â”‚ â”‚
â”‚  â”‚   status: "created",                                                    â”‚ â”‚
â”‚  â”‚   messages: []                                                          â”‚ â”‚
â”‚  â”‚ }                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                                                                     â”‚
â”‚         â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚ requirement_agent â”‚ â”€â”€â–º status: "requirement_submitted"                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     + extracted_keywords: ["OAuth", "authentication"] â”‚
â”‚         â”‚                                                                     â”‚
â”‚         â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚  â”‚ historical_match_agent â”‚ â”€â”€â–º status: "matches_found"                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     + all_matches: [{...}, {...}, {...}]        â”‚
â”‚         â”‚                       + timing: {historical_match_ms: 1250}        â”‚
â”‚         â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚ auto_select_node â”‚ â”€â”€â–º status: "matches_selected"                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     + selected_matches: [{...}, {...}, {...}]         â”‚
â”‚         â”‚                 + loaded_projects: {                               â”‚
â”‚         â”‚                     "PRJ-001": {tdd: {...}, estimation: {...}},    â”‚
â”‚         â”‚                     "PRJ-002": {...},                              â”‚
â”‚         â”‚                     "PRJ-003": {...}                               â”‚
â”‚         â”‚                   }                                                â”‚
â”‚         â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚ impacted_modules_agent  â”‚ â”€â”€â–º status: "impacted_modules_generated"        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     + impacted_modules_output: {                â”‚
â”‚         â”‚                            functional_modules: [...],              â”‚
â”‚         â”‚                            technical_modules: [...],               â”‚
â”‚         â”‚                            impact_summary: "..."                   â”‚
â”‚         â”‚                        }                                           â”‚
â”‚         â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚ estimation_effort_agent â”‚ â”€â”€â–º status: "estimation_effort_completed"       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     + estimation_effort_output: {               â”‚
â”‚         â”‚                            dev_hours: 120,                         â”‚
â”‚         â”‚                            qa_hours: 40,                           â”‚
â”‚         â”‚                            story_points: 34,                       â”‚
â”‚         â”‚                            confidence_level: "medium"              â”‚
â”‚         â”‚                        }                                           â”‚
â”‚         â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                              â”‚
â”‚  â”‚ tdd_agent  â”‚ â”€â”€â–º status: "tdd_generated"                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     + tdd_output: {                                         â”‚
â”‚         â”‚               tdd_name: "...",                                    â”‚
â”‚         â”‚               design_patterns: [...],                             â”‚
â”‚         â”‚               components: [...]                                   â”‚
â”‚         â”‚           }                                                        â”‚
â”‚         â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚ jira_stories_agentâ”‚ â”€â”€â–º status: "jira_stories_generated" â†’ "completed"   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     + jira_stories_output: {                         â”‚
â”‚         â”‚                      stories: [{summary, description, points}]    â”‚
â”‚         â”‚                  }                                                 â”‚
â”‚         â–¼                                                                     â”‚
â”‚  Final State                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ {                                                                        â”‚ â”‚
â”‚  â”‚   session_id: "sess-123",                                               â”‚ â”‚
â”‚  â”‚   requirement_text: "...",                                              â”‚ â”‚
â”‚  â”‚   extracted_keywords: [...],                                            â”‚ â”‚
â”‚  â”‚   all_matches: [...],                                                   â”‚ â”‚
â”‚  â”‚   selected_matches: [...],                                              â”‚ â”‚
â”‚  â”‚   loaded_projects: {...},                                               â”‚ â”‚
â”‚  â”‚   impacted_modules_output: {...},                                       â”‚ â”‚
â”‚  â”‚   estimation_effort_output: {...},                                      â”‚ â”‚
â”‚  â”‚   tdd_output: {...},                                                    â”‚ â”‚
â”‚  â”‚   jira_stories_output: {...},                                           â”‚ â”‚
â”‚  â”‚   status: "completed",                                                  â”‚ â”‚
â”‚  â”‚   timing: {historical_match_ms: 1250, ...},                            â”‚ â”‚
â”‚  â”‚   messages: [{role: "requirement", ...}, {role: "search", ...}, ...]   â”‚ â”‚
â”‚  â”‚ }                                                                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## SSE Streaming Flow

How Server-Sent Events deliver real-time progress to the frontend.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SSE STREAMING FLOW                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  FRONTEND                                 BACKEND                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   POST /impact/         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚             â”‚   run-pipeline/stream    â”‚                                 â”‚â”‚
â”‚  â”‚ EventSource â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚  StreamingResponse              â”‚â”‚
â”‚  â”‚             â”‚                          â”‚  (async generator)              â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚        â”‚                                            â”‚                         â”‚
â”‚        â”‚                                            â”‚                         â”‚
â”‚        â”‚    event: pipeline_start                   â”‚                         â”‚
â”‚        â”‚    data: {"session_id":"sess-123",         â”‚                         â”‚
â”‚        â”‚           "total_agents":7}                â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ yield event     â”‚   â”‚
â”‚        â”‚                                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â”‚                                            â”‚           â”‚            â”‚
â”‚  [Show progress: 0%]                                â”‚           â–¼            â”‚
â”‚        â”‚                                            â”‚  requirement_agent()   â”‚
â”‚        â”‚                                            â”‚           â”‚            â”‚
â”‚        â”‚    event: agent_complete                   â”‚           â”‚            â”‚
â”‚        â”‚    data: {"agent_name":"requirement",      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚        â”‚           "agent_index":1,                 â”‚  â”‚ yield event     â”‚   â”‚
â”‚        â”‚           "progress_percent":12.5}         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚        â”‚                                            â”‚                         â”‚
â”‚  [Show progress: 12.5%]                             â”‚           â–¼            â”‚
â”‚        â”‚                                            â”‚  historical_match()    â”‚
â”‚        â”‚                                            â”‚           â”‚            â”‚
â”‚        â”‚    event: agent_complete                   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚        â”‚    data: {"agent_name":"historical_match", â”‚  â”‚ yield event     â”‚   â”‚
â”‚        â”‚           "progress_percent":25}           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚        â”‚                                            â”‚                         â”‚
â”‚  [Show progress: 25%]                               â”‚                         â”‚
â”‚        â”‚                                            â”‚                         â”‚
â”‚        â”‚         ... (continue for each agent) ...  â”‚                         â”‚
â”‚        â”‚                                            â”‚                         â”‚
â”‚        â”‚    event: pipeline_complete                â”‚                         â”‚
â”‚        â”‚    data: {"session_id":"sess-123",         â”‚                         â”‚
â”‚        â”‚           "status":"completed",            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚        â”‚           "output":{...}}                  â”‚  â”‚ yield final     â”‚   â”‚
â”‚        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚        â”‚                                            â”‚                         â”‚
â”‚  [Show results]                                     â”‚                         â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Flow

How errors propagate and are handled in the workflow.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ERROR HANDLING FLOW                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  Normal Flow                     Error Flow                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ Some Agent   â”‚               â”‚ Some Agent   â”‚                            â”‚
â”‚  â”‚              â”‚               â”‚              â”‚                            â”‚
â”‚  â”‚ try:        â”‚               â”‚ try:        â”‚                            â”‚
â”‚  â”‚   result =  â”‚               â”‚   result =  â”‚                            â”‚
â”‚  â”‚   process() â”‚               â”‚   process() â”‚ â”€â”€â–º Exception raised!       â”‚
â”‚  â”‚ except:     â”‚               â”‚ except:     â”‚                            â”‚
â”‚  â”‚   ...       â”‚               â”‚   return {  â”‚                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚     "status": "error",                   â”‚
â”‚         â”‚                       â”‚     "error_message": str(e),             â”‚
â”‚         â–¼                       â”‚     "current_agent": "error_handler"     â”‚
â”‚  Return success                 â”‚   }         â”‚                            â”‚
â”‚  state update                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚         â”‚                              â”‚                                     â”‚
â”‚         â–¼                              â–¼                                     â”‚
â”‚  Continue to                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  next agent                    â”‚ Conditional Edge     â”‚                     â”‚
â”‚                                â”‚ route_after_agent()  â”‚                     â”‚
â”‚                                â”‚                      â”‚                     â”‚
â”‚                                â”‚ if status == "error":â”‚                     â”‚
â”‚                                â”‚   return "error_     â”‚                     â”‚
â”‚                                â”‚          handler"    â”‚                     â”‚
â”‚                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                           â”‚                                  â”‚
â”‚                                           â–¼                                  â”‚
â”‚                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                                â”‚  error_handler_node  â”‚                     â”‚
â”‚                                â”‚                      â”‚                     â”‚
â”‚                                â”‚  return {            â”‚                     â”‚
â”‚                                â”‚    "status": "error",â”‚                     â”‚
â”‚                                â”‚    "messages": [...] â”‚                     â”‚
â”‚                                â”‚  }                   â”‚                     â”‚
â”‚                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                           â”‚                                  â”‚
â”‚                                           â–¼                                  â”‚
â”‚                                          END                                 â”‚
â”‚                                                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                               â”‚
â”‚  Exception Hierarchy (app/components/base/exceptions.py):                    â”‚
â”‚                                                                               â”‚
â”‚  ComponentError (base)                                                        â”‚
â”‚  â”œâ”€â”€ SessionNotFoundError                                                    â”‚
â”‚  â”œâ”€â”€ InvalidSessionStateError                                                â”‚
â”‚  â”œâ”€â”€ RequirementTooShortError                                                â”‚
â”‚  â”œâ”€â”€ NoMatchesFoundError                                                     â”‚
â”‚  â”œâ”€â”€ AgentExecutionError                                                     â”‚
â”‚  â”œâ”€â”€ ResponseParsingError        â—„â”€â”€ Most common (LLM returns bad JSON)     â”‚
â”‚  â”œâ”€â”€ OllamaUnavailableError                                                  â”‚
â”‚  â”œâ”€â”€ OllamaTimeoutError                                                      â”‚
â”‚  â””â”€â”€ VectorDBError                                                           â”‚
â”‚                                                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                               â”‚
â”‚  JSON Parsing Recovery (app/utils/json_repair.py):                           â”‚
â”‚                                                                               â”‚
â”‚  parse_llm_json() handles:                                                    â”‚
â”‚  â€¢ Trailing commas in objects/arrays                                          â”‚
â”‚  â€¢ Unquoted keys                                                              â”‚
â”‚  â€¢ Truncated/incomplete JSON                                                  â”‚
â”‚  â€¢ Code blocks (```json ... ```)                                             â”‚
â”‚  â€¢ Mixed content before/after JSON                                            â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Storage Flow

How data flows to persistent storage during pipeline execution.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA STORAGE FLOW                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                       RUNTIME DATA FLOW                                  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   Agent Processing                                                       â”‚ â”‚
â”‚  â”‚        â”‚                                                                 â”‚ â”‚
â”‚  â”‚        â–¼                                                                 â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚  AuditTrailManager(session_id)                                   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  Location: app/utils/audit.py                                    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                                                                   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  audit.save_json("requirement.json", data, subfolder="step1")   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  audit.save_text("prompt.txt", prompt, subfolder="agent_tdd")   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  audit.record_timing("tdd_generation", 12500)                   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  audit.add_step_completed("tdd_generated")                       â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚        â”‚                                                                 â”‚ â”‚
â”‚  â”‚        â–¼                                                                 â”‚ â”‚
â”‚  â”‚   File System                                                            â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚  sessions/{date}/{session_id}/                                   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”œâ”€â”€ session_metadata.json      â—„â”€â”€ Session info, timing        â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”œâ”€â”€ step1_input/                                                â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”œâ”€â”€ requirement.json       â—„â”€â”€ Original requirement        â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â””â”€â”€ extracted_keywords.json                                 â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”œâ”€â”€ step2_historical_match/                                     â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”œâ”€â”€ historical_match_request.json  â—„â”€â”€ Search parameters   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”œâ”€â”€ all_matches.json       â—„â”€â”€ Full search results         â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â””â”€â”€ selected_matches.json  â—„â”€â”€ Selected top 3              â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”œâ”€â”€ step3_agents/                                               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”œâ”€â”€ agent_impacted_modules/                                 â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ input_prompt.txt   â—„â”€â”€ LLM prompt                  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ raw_response.txt   â—„â”€â”€ Raw LLM output              â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ llm_request.json   â—„â”€â”€ Request metadata            â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â””â”€â”€ parsed_output.json â—„â”€â”€ Structured output           â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”œâ”€â”€ agent_estimation/                                       â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â””â”€â”€ ...                                                 â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”œâ”€â”€ agent_tdd/                                              â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ input_prompt.txt                                    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ raw_response.txt                                    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â”œâ”€â”€ tdd.md             â—„â”€â”€ Generated TDD markdown      â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â”‚   â””â”€â”€ parsed_output.json                                  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   â””â”€â”€ agent_jira_stories/                                     â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚       â””â”€â”€ ...                                                 â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â””â”€â”€ final_summary.json         â—„â”€â”€ Complete assessment         â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      VECTOR DATABASE STORAGE                             â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   ChromaDB (data/chroma/)                                                â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚  Collections:                                                    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                                                                   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  impact_assessment_project_index (PRIMARY - used for search)â”‚  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  â€¢ Lightweight metadata per project                        â”‚  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  â€¢ Fields: project_id, project_name, summary               â”‚  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  â€¢ File paths: folder_path, tdd_path, estimation_path,     â”‚  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚               jira_stories_path                            â”‚  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  â€¢ Embedding: 384-dim vector (project_name + summary)      â”‚  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚  â€¢ HNSW index with cosine similarity                       â”‚  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                                                                   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  Note: Legacy collections (epics, estimations, tdds, stories)    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  are no longer used. Delete with reindex.py if present.          â”‚   â”‚ â”‚
â”‚  â”‚   â”‚                                                                   â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      PROJECT DATA STORAGE                                â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚   data/raw/projects/                                                     â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚   â”‚  PRJ-XXXXX-project-name/                                        â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”œâ”€â”€ tdd.docx              â—„â”€â”€ Required: Technical Design Doc   â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   Sections: Purpose, Scope, References, Module List,         â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   Design Overview, Module Designs, Risks                     â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚                                                               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”œâ”€â”€ estimation.xlsx       â—„â”€â”€ Effort estimation spreadsheet    â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   Sheets: Task Breakdown, Dev Estimate, QA Estimate,         â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚   Assumptions & Risks, Sizing Guidelines                     â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â”‚                                                               â”‚   â”‚ â”‚
â”‚  â”‚   â”‚  â””â”€â”€ jira_stories.xlsx     â—„â”€â”€ Existing Jira stories            â”‚   â”‚ â”‚
â”‚  â”‚   â”‚      Columns: JiraID, Description, Story Points, Priority       â”‚   â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Configuration Reference

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CONFIGURATION REFERENCE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚  Location: app/components/base/config.py                                     â”‚
â”‚  Override: .env file or environment variables                                 â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Setting                    â”‚ Default          â”‚ Description             â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  OLLAMA_BASE_URL            â”‚ localhost:11434  â”‚ Ollama server URL       â”‚ â”‚
â”‚  â”‚  OLLAMA_GEN_MODEL           â”‚ phi3:mini        â”‚ Text generation model   â”‚ â”‚
â”‚  â”‚  OLLAMA_EMBED_MODEL         â”‚ all-minilm       â”‚ Embedding model (384d)  â”‚ â”‚
â”‚  â”‚  OLLAMA_TIMEOUT_SECONDS     â”‚ 120              â”‚ LLM request timeout     â”‚ â”‚
â”‚  â”‚  OLLAMA_TEMPERATURE         â”‚ 0.3              â”‚ Generation temperature  â”‚ â”‚
â”‚  â”‚  OLLAMA_MAX_TOKENS          â”‚ 2048             â”‚ Max response tokens     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  CHROMA_PERSIST_DIR         â”‚ ./data/chroma    â”‚ ChromaDB storage path   â”‚ â”‚
â”‚  â”‚  CHROMA_COLLECTION_PREFIX   â”‚ impact_assessmentâ”‚ Collection name prefix  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  SEARCH_SEMANTIC_WEIGHT     â”‚ 0.70             â”‚ Semantic search weight  â”‚ â”‚
â”‚  â”‚  SEARCH_KEYWORD_WEIGHT      â”‚ 0.30             â”‚ Keyword search weight   â”‚ â”‚
â”‚  â”‚  SEARCH_MAX_RESULTS         â”‚ 10               â”‚ Max search results      â”‚ â”‚
â”‚  â”‚  SEARCH_MIN_SCORE_THRESHOLD â”‚ 0.3              â”‚ Minimum match score     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  DATA_RAW_PATH              â”‚ ./data/raw       â”‚ Raw data directory      â”‚ â”‚
â”‚  â”‚  DATA_UPLOADS_PATH          â”‚ ./data/uploads   â”‚ Uploaded files          â”‚ â”‚
â”‚  â”‚  DATA_SESSIONS_PATH         â”‚ ./sessions       â”‚ Session audit trails    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Quick Reference: Status Values

| Status | Description | Set By |
|--------|-------------|--------|
| `created` | Session initialized | Session service |
| `requirement_submitted` | Requirement parsed | requirement_agent |
| `matches_found` | Search completed | historical_match_agent |
| `matches_selected` | Top matches selected, docs loaded | auto_select_node |
| `impacted_modules_generated` | Modules identified | impacted_modules_agent |
| `estimation_effort_completed` | Effort estimated | estimation_effort_agent |
| `tdd_generated` | TDD created | tdd_agent |
| `jira_stories_generated` | Stories created | jira_stories_agent |
| `completed` | Pipeline finished | jira_stories_agent |
| `error` | Error occurred | Any agent or error_handler |

---

## Quick Reference: Active Agents

| Order | Agent | Input | Output |
|-------|-------|-------|--------|
| 1 | requirement_agent | requirement_text | extracted_keywords |
| 2 | historical_match_agent | requirement_text | all_matches |
| 3 | auto_select_node | all_matches | selected_matches, loaded_projects |
| 4 | impacted_modules_agent | loaded_projects | impacted_modules_output |
| 5 | estimation_effort_agent | loaded_projects + impacted_modules_output | estimation_effort_output |
| 6 | tdd_agent | loaded_projects | tdd_output |
| 7 | jira_stories_agent | loaded_projects | jira_stories_output |

---

## Quick Reference: Key File Locations

| Component | Location |
|-----------|----------|
| Workflow Definition | `app/components/orchestrator/workflow.py` |
| State Schema | `app/components/orchestrator/state.py` |
| Project Indexer | `app/services/project_indexer.py` |
| Hybrid Search | `app/rag/hybrid_search.py` |
| Vector Store | `app/rag/vector_store.py` |
| Embeddings | `app/rag/embeddings.py` |
| Context Assembler | `app/services/context_assembler.py` |
| TDD Parser | `app/services/parsers/tdd_parser.py` |
| Estimation Parser | `app/services/parsers/estimation_parser.py` |
| Jira Stories Parser | `app/services/parsers/jira_stories_parser.py` |
| Configuration | `app/components/base/config.py` |
| Audit Trail | `app/utils/audit.py` |
| JSON Repair | `app/utils/json_repair.py` |

---

*Document Version: 3.0*
*Last Updated: January 2026*
*Architecture: 2-Stage RAG with On-Demand Document Loading*
